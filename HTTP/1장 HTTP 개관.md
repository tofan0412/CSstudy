# 1장. HTTP 개관

생성일: 2021년 6월 29일 오후 5:49
태그: HTTP

→ 전세계의 웹 브라우저, 서버, 웹 어플리케이션은 모두 HTTP(Hypertext Transfer Protocol)를 통해 서로 대화한다. 즉, HTTP는 **현대 인터넷의 공용어**이다.

HTTP는 신뢰성 있는 데이터 전송 프로토콜을 사용하기 때문에, 데이터가 지구 반대편에서 오더라도 전송 중 손상되거나 꼬이지 않음을 보장한다. (신뢰성 있는 전송) 



### 1.2 웹 클라이언트와 서버

웹 컨텐츠는 웹 서버에 존재한다. 웹 서버는 HTTP 프로토콜로 의사소통하기 때문에 보통 HTTP 서버라고 불린다. 웹 서버( = HTTP 서버) 의 역할은 다음과 같다. 

1. 인터넷의 데이터를 저장한다. 
2. HTTP 클라이언트가 요청한 데이터를 제공한다.



### 1.3 웹 리소스

웹 서버는 웹 리소스를 관리하고 제공한다. 웹 리소스는 웹 컨텐츠의 원천이다. 가장 단순한 웹 리소스는 웹 서버 파일 시스템의 정적 파일이다. 

정적 파일 → TXT 파일, HTML 파일, Word 파일, 이미지 파일 등을 의미한다. 



### 1.3.1 미디어 타입

인터넷에 존재하는 파일의 종류는 수천 가지가 넘는다. 따라서 HTTP는 웹에서 전송되는 객체 각각에 신중하게 **MIME 타입(Multipurpose Internet Mail Extensions Type)**이라는 데이터 포맷 라벨을 붙인다. 본래 각기 다른 전자메일 시스템 사이에서 메시지가 오갈 때 겪는 문제점을 해결하기 위해 고안되었으나, HTTP에서도 멀티미디어 컨텐츠를 기술하고 라벨을 붙이기 위해 채택되었다. 

✔ 웹 서버는 모든 HTTP 객체 데이터에 MIME 타입을 붙인다. 

✔ **이는 아주 쉽게 확인할 수 있는데, 크롬 개발자 도구를 통해 전송되는 HTTP 객체의 Headers에서 `Content-type` 이라는 것을 확인할 수 있을 것이다. 이것이 바로 MIME Type이다**!

웹 브라우저(웹 클라이언트)는 웹 서버로부터 객체를 돌려받을 때, 다룰 수 있는 객체인지 MIME 타입을 통해 확인한다. 

MIME 타입은 사선(/)으로 구분되며 주 타입(primary object type)과 부 타입(specific subtype)으로 이루어진 문자열 라벨이다.  예를 들면 다음과 같다. 

- HTML로 작성된 텍스트 문서는 text/html 라벨이 붙는다.
- plain ASCII 텍스트 문서는 text/plain 라벨이 붙는다.

⚠ 플레인 텍스트(plain text)는 그래픽 표현이나 그 밖의 오브젝트(그림 등)이 아닌, **읽을 수 있는 자료의 문자열만을 대표하는 데이터이다.** 플레인 텍스트는 양식 정보가 포함된 리치 텍스트, 일부분이 이진 오브젝트(인코딩된 정수, 실수, 그림 등)로 대표되는 바이너리 파일과는 구별된다. (출처 : 위키백과)

- JPEG 이미지는 image/jpeg가 붙는다.
- GIF 이미지는 image/gif가 된다.



### 1.3.2 URI

웹 서버 리소스는 각자 이름을 갖고 있기 때문에, 클라이언트는 관심 있는 리소스를 지목할 수 있다. 서버 리소스 이름은 **통합 자원 식별자**(**uniform resource identifier**), 혹은 URI로 불린다. URI는 인터넷의 우편물 주소 같은 것으로, 정보 리소스를 고유하게 식별하고 위치를 지정할 수 있다. 

예를 들어 다음과 같은 URI가 있다고 하자. 

`**htps://www.joes-hardware.com/specials/saw-blade.gif**`

위 URI는 다음과 같이 구성된다.

1. HTTP 프로토콜을 사용한다는 뜻의 `http://` 
2. `[www.joes-hardware.com](http://www.joes-hardware.com)` 으로 이동해서 
3. `specials/saw-blade.gif` 리소스를 가져와라.

**URI에는 두 가지가 있는데, URL과 URN이라는 것이다.** 



### 1.3.3 URL

통합 자원 지시자(uniform resource locator, URL)는 리소스 식별자의 가장 흔한 형태이다. **URL은 특정 서버의 한 리소스에 대한 구체적인 위치를 서술한다**. 

대부분의 URL은 세 부분으로 이루어진 표준 포맷을 따른다.

1. URL의 첫번째 부분은 스킴(scheme)이라고 불리는데, 리소스에 접근하기 위해 사용되는 프로토콜을 서술한다. 보통 HTTP 프로토콜(`http://` 또는 `https://` )이다.
2. 두번째 부분은 서버의 인터넷 주소를 제공한다.
3. 마지막은 웹 서버의 리소스를 가리킨다. 

오늘날 대부분의 URI는 URL이다. 따라서 특별한 언급이 없는 한, **통상적인 관례에 따라 URI와 URL을 같은 의미로 사용할 것이다.** 



### 1.3.4 URN

URI의 두 번째 종류는 유니폼 리소스 이름(uniform resoure name, URN)이다. URN은 컨텐츠를 이루는 한 리소스에 대해, **그 리소스의 위치에 영향 받지 않는 유일무이한 이름 역할**을 한다. **이 위치 독립적인 URN은 리소스를 여기저기로 옮기더라도 문제없이 동작한다**. 또한 리소스가 그 이름을 변하지 않게 유지하는 한, 여러 종류의 네트워크 접속 프로토콜로 접근해도 문제없다.



### 1.4 Transaction

HTTP 트랜잭션은 요청 명령(클라이언트 → 서버)과 응답 결과(서버 → 클라이언트)로 구성되어 있다. 이러한 상호작용은 **HTTP 메시지**라고 불리는 정형화된 데이터 덩어리를 이용해 이뤄진다.

⚠ 예) 클라이언트가 서버에 요청을 보내는 경우의 **HTTP 요청 메시지**: 

`GET /specials/saw-blade.gif HTTP/1.0 Host: [www.joes-hardware.com](http://www.joes-hardware.com)`

서버가 이에 응답하는 경우의 **HTTP 응답 메시지**:

`HTTP/1.0 200 OK Content-type: image/gif Content-length: 8572`



### 1.4.1 메서드

HTTP는 HTTP 메서드라고 불리는 여러 가지 종류의 요청 명령을 지원한다.  모든 HTTP 요청 메시지는 한 개의 메서드를 갖는다. 메서드는 서버에게 어떤 동작이 취해져야 하는지 말해준다. 

[HTTP 메서드의 종류](https://www.notion.so/62cda7bbb1f347e18879b3662635c3bb)



### 1.4.2 상태 코드

모든 HTTP 응답 메시지는 상태코드와 함께 반환된다. 



### 1.4.3 웹페이지는 여러 객체로 이루어질 수 있다.



### 1.5 메시지

HTTP 요청/응답 메시지는 단순한 줄 단위의 문자열이다. 이진 형식이 아닌 일반 텍스트이기 때문에 사람이 읽고 쓰기 쉽다. 

1. 웹 클라이언트에서 웹 서버로 보낸 HTTP 메시지를 **HTTP 요청 메시지**라고 부른다. 
2. 서버에서 웹 클라이언트로 가는 메시지는 **HTTP 응답 메시지**라고 부른다.

⚠ 그 외에 다른 종류의 HTTP 메시지는 존재하지 않는다.

HTTP 메시지는 다음의 세 부분으로 나뉜다.

**시작줄**

요청이라면 무엇을 해야 하는지, 응답이라면 무슨 일이 일어났는지를 나타낸다.

**헤더**

시작줄 다음에는 0개 이상의 헤더 필드가 이어진다. 각 헤더 필드는 쉬운 구문분석을 위해 콜론(:)으로 구분되어 있는 하나의 이름과 하나의 값으로 구성된다. 헤더 필드를 추가하려면 그저 한 줄을 더하기만 하면 된다. **헤더는 빈 줄로 끝난다.**

**본문**

어떤 종류의 데이터가 들어갈 수 있는 공간이다. 요청 메시지의 경우 웹 서버로 데이터를 실어 보내며, 응답 메시지의 경우 클라이언트로 반환할 데이터가 담겨져 있다. 시작줄과 헤더가 문자열로 이루어져 있는 것과 달리, 본문의 경우 이진 데이터를 포함할 수 있다. (사진이나 동영상, 오디오 트랙 등이 반환될 수 있으므로)



### 1.6 TCP 커넥션

이제 어떻게 메시지가 **TCP(Transmission Control Protocol, 전송 제어 프로토콜)** 커넥션을 통해 한 곳에서 다른 곳으로 옮겨가는지 잠깐 이야기해보도록 하자.



### 1.6.1 TCP/IP

HTTP는 어플리케이션 계층 프로토콜이다. HTTP는 네트워크 통신의 핵심적인 세부사항에 대해서 신경쓰지 않는다. 대신 대중적이고 신뢰성 있는 인터넷 전송 프로토콜인 TCP/IP에게 맡긴다.

TCP는 다음을 제공한다. 

- 오류 없는 데이터 전송
- 순서에 맞는 전달(데이터는 언제나 보낸 순서대로 도착한다.)
- 조각나지 않는 데이터 스트림(언제든 어떤 크기로든 보낼 수 있다.)

→ TCP/IP는 TCP와 IP가 층을 이루는, 패킷 교환 네트워크 프로토콜의 집합이다. TCP/IP는 **각 네트워크와 하드웨어의 특성을 숨기고, 어떤 종류의 컴퓨터나 네트워크든 서로 신뢰성 있는 의사소통을 하게 해준다.** 

**일단 TCP 커넥션이 맺어지면, 클라이언트와 서버 컴퓨터 간에 교환되는 HTTP 메시지가 없어지거나, 손상되거나, 순서가 뒤바뀌어 수신되는 일은 결코 없다.**



### 1.6.2 접속, IP 주소 그리고 포트번호

클라이언트 ↔ 서버 간 HTTP 메시지를 교환가능하게 하려면, 인터넷 프로토콜(Internet Protocol, IP) 주소와 포트 번호를 사용해 클라이언트와 서버 사이에 TCP/IP 커넥션을 맺어야 한다. TCP에서는 **서버 컴퓨터에 대한 IP 주소**와, **그 서버에서 실행 중인 프로그램이 사용 중인 포트번호**가 필요하다. 이를 알아내려면 앞서 공부한 URL을 이용하면 된다. 몇가지 URL을 살펴보자.

1. [http://207.200.83.29:80/index.html](http://207.200.83.29:80/index.html)
2. [http://www.netscape.com:80/index.html](http://www.netscape.com:80/index.html)
3. [http://www.netscape.com/index.html](http://www.netscape.com/index.html)

→ 첫번째 URL의 경우 IP 주소와 포트 번호가 기재되어 있다. 

→ 두번째 URL에는 숫자로 된 IP 주소가 없다. 대신 글자로 된 **도메인 이름** 혹은 **호스트명**(이 경우 [www.netscape.com](http://www.netscape.com))을 갖고 있다. 호스트 명은 IP 주소의 별명이라고 생각하면 된다. 

⚠ 호스트 명은 **도메인 이름 서비스(Domain Name Service, DNS)**라 불리는 장치를 통해 쉽게 IP로 변환될 수 있다. 

→ 세번째의 경우 포트번호가 없는데, 포트 번호가 빠진 경우에는 기본 포트 번호를 80으로 가정한다. 

✔ **클라이언트 - 서버 간 통신 과정**

(a) 클라이언트는 서버의 URL에서 호스트 명을 추출한다. (ex: [naver.com](http://naver.com))

(b) 클라이언트는 서버의 호스트 명을 IP로 변환한다. (with DNS!)

(c) 클라이언트는 URL에서 포트번호(있다면)를 추출한다. 

(d) (a) ~ (c) 의 과정을 통해 TCP 커넥션을 맺는다.

(e) 클라이언트는 HTTP 요청 메시지를 서버에 전송한다.

(f) 서버는 클라이언트로부터 HTTP 요청 메시지를 받아, 로직을 처리한 후 HTTP 응답 메시지를 보낸다.

(g) 커넥션이 닫히면, 클라이언트는 응답 메시지에 포함되어 있는 데이터를 출력한다.



### 1.8 웹의 구성요소

**프록시(Proxy)**: 클라이언트 - 서버 사이에 위치한 HTTP 중개자

**캐시**: 많이 찾는 웹페이지를 클라이언트 가까이에 보관하는 HTTP 창고

**게이트웨이**: 다른 어플리케이션과 연결된 특별한 웹 서버

**터널**: 단순히 HTTP 통신을 전달하기만 하는 특별한 프록시



### 1.8.1 프록시 (Proxy)

프록시는 Client와 Server 사이에 위치하여, **클라이언트의 모든 HTTP 요청을 받아 서버에 전달한다** ( 대개 요청을 수정한 뒤에). 사용자를 대신해서 서버에 접근한다. 프록시는 주로 보안을 위해 사용된다. **즉 모든 웹 트래픽 흐름 속에서 신뢰할 만한 중개자 역할을 한다.** 또한 프록시는 요청과 응답을 필터링한다. 예를 들어 회사에서 무엇인가를 다운받을 때, 애플리케이션 바이러스를 검출하거나 초등학교 학생들에게서 유해 성인 컨텐츠를 차단한다. 



### 1.8.2 캐시 (Cache)



### 1.8.3 게이트웨이

게이트웨이는 다른 서버들의 중개자로 동작하는 특별한 서버이다. 게이트웨이는 주로 HTTP 트래픽을 다른 프로토콜로 변환하기 위해 사용된다.